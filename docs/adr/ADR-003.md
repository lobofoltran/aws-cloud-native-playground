# ADR-003: Use EventBridge/SNS for Event Routing Instead of Direct Queue Subscription

## Status
Accepted

## Context

As the AWS Cloud-Native Playground adopts an event-driven architecture, services need a mechanism to **publish and consume events** without tight coupling.

Two primary approaches were considered:

1. **Direct Queue Subscription**
   - Producers publish directly to specific SQS queues
2. **Event Routing Layer**
   - Producers publish events to a routing service (SNS or EventBridge)
   - Consumers subscribe independently

The platform aims to prioritize **decoupling, extensibility, and platform-level flexibility** over minimal configuration.

---

## Decision

The platform will use **Amazon EventBridge and/or Amazon SNS** as an **event routing layer**, instead of having producers publish directly to consumer-owned SQS queues.

Producers emit domain events to a central event bus or topic.  
Consumers subscribe to events via queues managed independently.

---

## Rationale

### Why an Event Routing Layer

Using EventBridge or SNS provides:

- Strong decoupling between producers and consumers
- Independent evolution of services
- Easy fan-out to multiple consumers
- Centralized event visibility
- Reduced need for producer changes when consumers evolve

This aligns with **platform engineering principles**, where producers do not need to know who consumes their events.

---

### SNS vs EventBridge

Both services are valid and complementary:

- **SNS**
  - Simple pub/sub
  - Low latency
  - Ideal for straightforward fan-out

- **EventBridge**
  - Schema-aware event routing
  - Filtering and transformation
  - Better suited for domain events

The platform may use **either or both**, depending on the scenario being explored.

---

## Consequences

### Positive
- Loose coupling between services
- Easier addition of new consumers
- Clear separation between event producers and consumers
- Improved extensibility of the platform

### Negative
- Additional infrastructure components
- Slightly higher latency compared to direct queue publishing
- More complex event flow to reason about

These trade-offs are accepted to favor **scalability of architecture and learning depth**.

---

## Alternatives Considered

### Direct Queue Subscription

**Pros**
- Simpler setup
- Lower latency
- Fewer moving parts

**Cons**
- Tight coupling between producers and queues
- Harder to add new consumers
- Producers must be aware of consumer topology

This approach was rejected as it does not scale well from a platform perspective.

---

## Scope

This decision applies to:
- Domain event publication
- Asynchronous service communication
- Fan-out scenarios

It does not prohibit direct SQS usage for:
- Internal background jobs
- Single-consumer task queues

---

## Notes

This ADR reinforces a **domain-event mindset**, where services emit facts about what happened, not instructions about what should consume them.

The routing layer acts as a **platform capability**, not an application concern.
